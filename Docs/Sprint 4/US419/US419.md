# US 406 -  As the Ship Captain I want to know where to position, for example, one hundred (100) containers on the vessel, such that the center of mass remains at xx and yy, determined in the previous point
## 1. Requirements Engineering

## 1.1. User Story Description

As the Ship Captain I want to know where to position, for example, one hundred
(100) containers on the vessel, such that the center of mass remains at xx and yy,
determined in the previous point.

## 1.2. Acceptance Criteria

* **AC1:** Identify the area/volume of a container and its center of mass. The distribution of the mass inside the container will be considered uniform.
* **AC2:** Make a sketch of the distribution and loading on the vessel.
* **AC3:** Calculate the center of mass of the sketch performed.
## 1.3. System Sequence Diagram (SSD)

![US404_SSD](US419%20SSD.svg)

## 2. OO Analysis

### Relevant Domain Model Excerpt

![US404_MD](US419%20MD.svg)

## 3. Design - User Story Realization

### 3.1. Sequence Diagram (SD)

![US401_SD](US419%20SD.svg)

### 3.2. Class Diagram (CD)

![US401_CD](US419%20CD.svg)


##5 Classes:

###CalculateCenterOfMassControler

    public class CargoCenterOfMassController {


    /**
     * Calculates the center of mass of a given Vessel for a given Cargo Manifest (X number of containers)
     * @param list recieves all containers positions inside that cargo manifest
     * @return the center of mass of that cargo manifest
     */
    public double calculateCenter(List<Double> list) {
        return PhysicsCalculation.calculateCenterMassOneDim(list);
    }
    }

###CalculateCenterOfMassUI

    public class CargoCenterOfMassUI implements Runnable {

    private final CargoCenterOfMassController controller;
    private final DecimalFormat df;

    public CargoCenterOfMassUI() {
        controller = new CargoCenterOfMassController();
        df = new DecimalFormat("0.00");
    }

    @Override
    public void run() {

        List<Double> listOfContainersPerN = new ArrayList<>();
        String option = "Length";
        String optionCoord = "x";
        StringBuilder sb = new StringBuilder();
        sb.append("\nVessel Type: 71").append("\nTotal center of the cargo (given the containers) is (");
        int nContainers = 0;
        double position = 0;

        do {
            try {
                nContainers = Utils.readIntegerFromConsole("\nPlease enter the maximum number of containers that you wish to have (by coordinate) inside the cargo manifest ");

                if (nContainers < 0) {
                    throw new NullPointerException("\nYou can not enter negative values! Or even a nContainers that surpasses 100 (According to the acceptance criteira)!");
                }

            } catch (IllegalArgumentException exception) {
                System.out.println("Please do not enter a letter of a symbol! (Notice we are reading a integer number for the max containers!)");
                nContainers = 0;
            } catch (NullPointerException ex2) {
                System.out.println("There was an error while trying to read the coordinates! Please try again!");
                nContainers = 0;
            } catch (Exception ex1) {
                System.out.println("There was an error while trying to read the coordinates! Please try again!");
                nContainers = 0;
            }

        } while (nContainers == 0);

        for (int j = 0; j < 3; j++) {
            if (j == 1) option = "Width";
            else if (j == 2) option = "Height";

            for (int i = 0; i < nContainers; i++) {
                try {
                    position = Utils.readIntegerFromConsole("\nPlease enter the container that you wish to have for the cargo manifest ( " + option + "):");

                    listOfContainersPerN.add(position);

                } catch (IllegalArgumentException | NullPointerException exception) {
                    System.out.println(exception.getMessage());
                } catch (Exception ex) {
                    System.out.println("\nThere was an error while trying to read the coordinates! Please try again!");
                    nContainers = 0;

                }

            }

            if (j == 1) optionCoord = "y";
            else if (j == 2) optionCoord = "z";
            else optionCoord = "x";
            sb.append(" " + optionCoord + ":");
            sb.append(df.format(controller.calculateCenter(listOfContainersPerN)));
            if (j != 2) {
                sb.append(",");
            } else {
                sb.append(")");
            }
            listOfContainersPerN = new ArrayList<>();
        }


        try {
            System.out.println(sb.toString());
        } catch (NullPointerException e) {
            System.out.println("\nThere was en error calculating the center of the mass! Please try again!");
            System.out.println("\nOperation failed!!");
        }

        sb = new StringBuilder();

    }
    }

###PhysicsCalculation

    public class PhysicsCalculation {

    /**
     * Calculates the energy needed to supply to a container of -5ºC with an exterior temperature of 20ºC and a travel time of 2h30.
     *
     * @return the energy needed to supply to a container of -5ºC with an exterior temperature of 20ºC and a travel time of 2h30
     */
    public static double calculateEnergyConsumptionDeterminedTripMinus5C() {
        double stainlessSteelResistance = 0.95 / (15 * Constants.AREA);
        double polyurethaneFoamResistance = 30 / (0.029 * Constants.AREA);
        double marinePlywoodResistance = 11.75 / (0.13 * Constants.AREA);

        double totalResistance = stainlessSteelResistance + polyurethaneFoamResistance + marinePlywoodResistance;

        // Q = temperature difference / total resistance
        double q = (20 + 5.0) / totalResistance;

        //Return = Q x time
        return (q * Constants.VOYAGE_TIME);
    }

    /**
     * Calculates the energy needed to supply to a container of 7ºC with an exterior temperature of 20ºC and a travel time of 2h30.
     *
     * @return the energy needed to supply to a container of 7ºC with an exterior temperature of 20ºC and a travel time of 2h30
     */
    public static double calculateEnergyConsumptionDeterminedTrip7C() {
        double cortenSteelResistance = 2 / (25 * Constants.AREA);
        double extrudedPolystyreneResistance = 6.10 / (3.30 * Constants.AREA);
        double marinePlywoodResistance = 11.75 / (0.13 * Constants.AREA);

        double totalResistance = cortenSteelResistance + extrudedPolystyreneResistance + marinePlywoodResistance;

        // Q = temperature difference / total resistance
        double q = (20 - 7.0) / totalResistance;

        //Return = Q x time
        return (q * Constants.VOYAGE_TIME);
    }

    /**
     * Calculates the total energy to be supplied to a set of containers of -5ºC.
     *
     * @param numberOfContainers the number of containers
     * @param temperature        the container temperature
     * @param voyageTime         the trip time
     * @return the total energy to be supplied to a set of containers of -5ºC
     */
    public static double calculateTotalEnergySuppliedMinus5(int numberOfContainers, double temperature, int voyageTime) {
        double stainlessSteelResistance = 0.95 / (15 * Constants.AREA);
        double polyurethaneFoamResistance = 30 / (0.029 * Constants.AREA);
        double marinePlywoodResistance = 11.75 / (0.13 * Constants.AREA);

        double totalResistance = stainlessSteelResistance + polyurethaneFoamResistance + marinePlywoodResistance;

        // Q = temperature difference / total resistance
        double q = (temperature + 5.0) / totalResistance;

        //Energy = Q x time
        double energy = q * voyageTime;

        return (energy * numberOfContainers);
    }

    /**
     * Calculates the total energy to be supplied to a set of containers of 7ºC.
     *
     * @param numberOfContainers the number of containers
     * @param temperature        the container temperature
     * @param voyageTime         the trip time
     * @return the total energy to be supplied to a set of containers of 7ºC
     */
    public static double calculateTotalEnergySupplied7(int numberOfContainers, double temperature, int voyageTime) {
        double cortenSteelResistance = 2 / (25 * Constants.AREA);
        double extrudedPolystyreneResistance = 6.10 / (3.30 * Constants.AREA);
        double marinePlywoodResistance = 11.75 / (0.13 * Constants.AREA);

        double totalResistance = cortenSteelResistance + extrudedPolystyreneResistance + marinePlywoodResistance;

        // Q = temperature difference / total resistance
        double q = (temperature - 7.0) / totalResistance;

        //Energy = Q x time
        double energy = q * voyageTime;

        return (energy * numberOfContainers);
    }

    /**
     * Calculates the energy needed to supply to the container cargo (with a temperature of -5ºC) in a voyage, depending on the position of the containers on the ship.
     *
     * @param section    the trip section
     * @param frontFaces the number of front faces
     * @param sideFaces  the number of side faces
     * @param topFaces   the number of top faces
     * @return the energy needed to supply to the container cargo (with a temperature of -5ºC) in a voyage, depending on the position of the containers on the ship
     */
    public static double calculateEnergyConsumptionMinus5(Map<Integer, Double> section, int frontFaces, int sideFaces, int topFaces) {

        double areaFront = frontFaces * Constants.CONTAINER_HEIGHT * Constants.CONTAINER_WIDTH;
        double areaSide = sideFaces * Constants.CONTAINER_HEIGHT * Constants.CONTAINER_LENGTH;
        double areaTop = topFaces * Constants.CONTAINER_WIDTH * Constants.CONTAINER_LENGTH;
        double areaTotal = areaFront + areaSide + areaTop;
        double thermalResistance = (1 / areaTotal) * (Constants.CONTAINER_EXTERIOR_MINUS5 / Double.parseDouble(System.getProperty("thermalConductivity.outer.minus5"))) + (Constants.CONTAINER_MID_MINUS5 / Double.parseDouble(System.getProperty("thermalConductivity.mid.minus5"))) + (Constants.CONTAINER_INTERIOR / Double.parseDouble(System.getProperty("thermalConductivity.inner.minus5")));

        double total = 0;
        for (Map.Entry<Integer, Double> entry : section.entrySet()) {

            total += (Math.abs(entry.getValue() - (-5)) / thermalResistance) * entry.getKey();

        }

        return total;
    }

    /**
     * Calculates the energy needed to supply to the container cargo (with a temperature of 7ºC) in a voyage, depending on the position of the containers on the ship.
     *
     * @param section    the trip section
     * @param frontFaces the number of front faces
     * @param sideFaces  the number of side faces
     * @param topFaces   the number of top faces
     * @return the energy needed to supply to the container cargo (with a temperature of 7ºC) in a voyage, depending on the position of the containers on the ship
     */
    public static double calculateEnergyConsumption7(Map<Integer, Double> section, int frontFaces, int sideFaces, int topFaces) {
        double areaFront = frontFaces * Constants.CONTAINER_HEIGHT * Constants.CONTAINER_WIDTH;
        double areaSide = sideFaces * Constants.CONTAINER_HEIGHT * Constants.CONTAINER_LENGTH;
        double areaTop = topFaces * Constants.CONTAINER_WIDTH * Constants.CONTAINER_LENGTH;
        double areaTotal = areaFront + areaSide + areaTop;

        double thermalResistance = (1 / areaTotal) * (Constants.CONTAINER_EXTERIOR_7 / Double.parseDouble(System.getProperty("thermalConductivity.outer.7")) + (Constants.CONTAINER_MID_7 / Double.parseDouble(System.getProperty("thermalConductivity.mid.7"))) + (Constants.CONTAINER_INTERIOR / Double.parseDouble(System.getProperty("thermalConductivity.inner.7"))));

        double total = 0;
        for (Map.Entry<Integer, Double> entry : section.entrySet()) {
            total += (Math.abs(entry.getValue() - 7) / thermalResistance) * entry.getKey();
        }

        return total;
    }

    /**
     * Calculates the energy needed to supply to the container cargo (with a temperature of 7ºC) in a voyage, depending on the position of the containers on the ship.
     *
     * @param numberOfContainers the number of containers
     * @param temperature        the container temperature
     * @param voyageTime         the voyage time
     * @return the energy needed to supply to the container cargo (with a temperature of 7ºC) in a voyage, depending on the position of the containers on the ship
     */
    public static int calculateSuppliesNeededFor7(int numberOfContainers, double temperature, int voyageTime) {
        double energykw = (calculateTotalEnergySupplied7(numberOfContainers, temperature, voyageTime));
        int supliesNeeded = (int) Math.abs(Math.round(energykw / (75 * 1000)));

        if (supliesNeeded == 0) supliesNeeded = 1;

        return supliesNeeded;
    }

    /**
     * Calculates the energy needed to supply to the container cargo (with a temperature of -5ºC) in a voyage, depending on the position of the containers on the ship.
     *
     * @param numberOfContainers the number of containers
     * @param temperature        the container temperature
     * @param voyageTime         the voyage time
     * @return the energy needed to supply to the container cargo (with a temperature of -5ºC) in a voyage, depending on the position of the containers on the ship
     */
    public static int calculateSuppliesNeededForMinus5(int numberOfContainers, double temperature, int voyageTime) {
        double energykw = (calculateTotalEnergySuppliedMinus5(numberOfContainers, temperature, voyageTime));
        int supliesNeeded = (int) Math.abs(Math.round(energykw / (75 * 1000 * voyageTime)));

        if (supliesNeeded == 0) supliesNeeded = 1;

        return supliesNeeded;
    }

    /**
     * Calculates the center of mass from a certain Ship given a certain cargo manifest
     * @param positionList List that has all the containers of a certain cargo Manifest
     * @return the center of mass
     */

    public static double calculateCenterMassOneDim(List<Double> positionList) {
        if (positionList.size() == 0) {
            return 0;
        }
        double sum = 0;
        for (Double d : positionList) {
            sum += d;
        }
        return sum / positionList.size();
    }


    }